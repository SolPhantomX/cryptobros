<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CryptoBros Help Desk</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Roboto+Mono:wght@400;500&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg-body: #f8f9fa; --bg-card: #ffffff; --text-primary: #212529;
      --text-secondary: #6c757d; --border-color: #e9ecef; --shadow: 0 4px 12px rgba(0,0,0,0.05);
      --accent-gold: #FFD700; --accent-cyan: #00F0FF; --accent-purple: #9D00FF;
      --hover-bg: #f1f3f5; --success: #00ff9d; --warning: #ffd700; --error: #ff4d4d;
    }
    .dark-theme {
      --bg-body: #121212; --bg-card: #1e1e1e; --text-primary: #e0e0e0;
      --text-secondary: #a0a0a0; --border-color: #333333; --shadow: 0 4px 12px rgba(0,0,0,0.3);
      --hover-bg: #2a2a2a;
    }
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: 'Inter', sans-serif; background: var(--bg-body); color: var(--text-primary);
      min-height: 100vh; transition: background 0.3s ease; padding: 2rem;
    }
    .container { max-width: 800px; margin: 0 auto; }
    .header {
      text-align: center; padding: 2rem 0; border-bottom: 2px solid var(--accent-gold); margin-bottom: 2rem;
    }
    .header h1 { font-size: 2rem; color: var(--accent-gold); margin-bottom: 0.5rem; }
    .header p { color: var(--text-secondary); }
    .search-box {
      background: var(--bg-card); border: 2px solid var(--border-color); border-radius: 16px;
      padding: 1.5rem; margin-bottom: 2rem; box-shadow: var(--shadow);
    }
    .search-box input {
      width: 100%; padding: 1rem; border: 2px solid var(--border-color); border-radius: 12px;
      font-size: 1rem; background: var(--bg-body); color: var(--text-primary); margin-bottom: 1rem;
    }
    .search-box input:focus { outline: none; border-color: var(--accent-gold); }
    .search-btn {
      width: 100%; padding: 1rem; background: linear-gradient(135deg, var(--accent-gold), var(--accent-cyan));
      border: none; border-radius: 12px; font-weight: 700; color: #0a0a0f; cursor: pointer;
      transition: all 0.3s;
    }
    .search-btn:hover { transform: translateY(-2px); box-shadow: 0 4px 20px rgba(255, 215, 0, 0.4); }
    .categories {
      display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 0.75rem; margin-bottom: 2rem;
    }
    .category-btn {
      padding: 0.8rem; background: var(--bg-card); border: 2px solid var(--border-color);
      border-radius: 12px; font-weight: 600; color: var(--text-primary); cursor: pointer;
      transition: all 0.2s; text-align: center;
    }
    .category-btn:hover, .category-btn.active {
      border-color: var(--accent-gold); background: rgba(255, 215, 0, 0.1);
    }
    .response-area {
      background: var(--bg-card); border-radius: 16px; padding: 2rem;
      box-shadow: var(--shadow); margin-bottom: 2rem; display: none;
    }
    .response-area.visible { display: block; animation: fadeIn 0.3s ease-out; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    .response-header {
      display: flex; align-items: center; gap: 0.75rem; margin-bottom: 1rem; padding-bottom: 1rem;
      border-bottom: 1px solid var(--border-color);
    }
    .response-avatar {
      width: 48px; height: 48px; border-radius: 50%;
      background: linear-gradient(135deg, var(--accent-purple), var(--accent-cyan));
      display: flex; align-items: center; justify-content: center; color: #0a0a0f; font-weight: 700;
    }
    .response-title { font-weight: 700; color: var(--accent-gold); }
    .response-content { line-height: 1.7; color: var(--text-primary); }
    .response-content a { color: var(--accent-cyan); text-decoration: none; }
    .response-content a:hover { text-decoration: underline; }
    .escalation {
      background: var(--bg-body); border-radius: 12px; padding: 1.5rem; margin-top: 1.5rem;
      border-left: 4px solid var(--accent-purple);
    }
    .escalation h4 { margin-bottom: 1rem; color: var(--accent-purple); }
    .escalation-links { display: flex; flex-wrap: wrap; gap: 0.5rem; }
    .escalation-btn {
      padding: 0.6rem 1.2rem; border: none; border-radius: 8px; font-weight: 600;
      cursor: pointer; transition: all 0.2s; font-size: 0.9rem;
    }
    .escalation-btn.email { background: var(--bg-card); border: 2px solid var(--border-color); color: var(--text-primary); }
    .escalation-btn.twitter { background: #000; color: white; }
    .escalation-btn:hover { transform: translateY(-2px); }
    .faq-history {
      background: var(--bg-card); border-radius: 16px; padding: 2rem;
      box-shadow: var(--shadow);
    }
    .faq-history h3 { margin-bottom: 1rem; color: var(--accent-gold); }
    .faq-item {
      padding: 1rem; border-bottom: 1px solid var(--border-color);
    }
    .faq-item:last-child { border-bottom: none; }
    .faq-question { font-weight: 600; color: var(--text-primary); margin-bottom: 0.3rem; }
    .faq-answer { color: var(--text-secondary); font-size: 0.95rem; }
    .toast {
      position: fixed; bottom: 30px; right: 30px; padding: 1rem 1.5rem;
      background: var(--bg-card); border: 2px solid var(--success); border-radius: 12px;
      color: var(--text-primary); font-weight: 600; z-index: 9999;
      animation: toastIn 0.3s ease-out;
    }
    .toast.error { border-color: var(--error); }
    @keyframes toastIn { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
    .sound-indicator {
      position: fixed; bottom: 30px; left: 30px; padding: 0.5rem 1rem;
      background: var(--bg-card); border-radius: 8px; font-size: 0.85rem;
      color: var(--text-secondary); border: 1px solid var(--border-color);
    }
    @media (max-width: 600px) {
      body { padding: 1rem; }
      .categories { grid-template-columns: 1fr 1fr; }
      .escalation-links { flex-direction: column; }
      .escalation-btn { width: 100%; }
    }
  </style>
</head>
<body>
<div class="container">
  <div class="header">
    <h1>ü§ñ Tribunal Help Desk</h1>
    <p>Ask anything. Get instant answers from the CryptoBros knowledge base.</p>
  </div>
  <div class="search-box">
    <input type="text" id="helpInput" placeholder="Describe your issue (e.g., 'wallet not connecting', 'post disappeared')...">
    <button class="search-btn" onclick="askHelp()">üîç Ask Tribunal AI</button>
  </div>
  <div class="categories">
    <button class="category-btn active" onclick="filterCategory('all')">All</button>
    <button class="category-btn" onclick="filterCategory('wallet')">üîê Wallet</button>
    <button class="category-btn" onclick="filterCategory('scam')">üö® Scam</button>
    <button class="category-btn" onclick="filterCategory('posts')">üìù Posts</button>
    <button class="category-btn" onclick="filterCategory('tribunal')">‚öñÔ∏è Tribunal</button>
  </div>
  <div class="response-area" id="responseArea">
    <div class="response-header">
      <div class="response-avatar">ü§ñ</div>
      <div>
        <div class="response-title">Tribunal AI Assistant</div>
        <div style="font-size:0.85rem;color:var(--text-secondary)">Instant response</div>
      </div>
    </div>
    <div class="response-content" id="responseContent"></div>
    <div class="escalation">
      <h4>Still need help?</h4>
      <p style="color:var(--text-secondary);margin-bottom:1rem;font-size:0.95rem;">
        Contact <strong>@MaxCaneCrypto</strong> directly for personalized assistance:
      </p>
      <div class="escalation-links">
        <button class="escalation-btn email" onclick="escalate('email')">
          ‚úâÔ∏è cryptobros.official10@gmail.com
        </button>
        <button class="escalation-btn twitter" onclick="escalate('twitter')">
          üê¶ DM on X (Direct Message)
        </button>
      </div>
      <p style="font-size:0.8rem;color:var(--text-secondary);margin-top:0.75rem;">
        üí° Responses within 24‚Äì48 hours. For urgent issues, use X/Twitter DM.
      </p>
    </div>
  </div>
  <div class="faq-history">
    <h3>üìö Recent Questions</h3>
    <div id="faqList">
      <p style="color:var(--text-secondary);text-align:center;">No questions yet. Be the first to ask!</p>
    </div>
  </div>
</div>
<div class="sound-indicator" id="soundIndicator">üîä Sounds: ON</div>

<script>
  // === HELP DESK SYSTEM (NO SERVER) ===
  
  const KNOWLEDGE_BASE = {
    wallet: {
      keywords: ['wallet', 'phantom', 'connect', 'sign', 'extension', 'metamask'],
      answer: `To connect your wallet:<br>
        1. Install <a href="https://phantom.app" target="_blank">Phantom</a> or MetaMask extension<br>
        2. Refresh the CryptoBros page<br>
        3. Click "Connect Wallet" in the sidebar<br>
        4. Approve the connection in your wallet<br><br>
        <strong>Still stuck?</strong> Try clearing browser cache or using Chrome/Brave.`,
      therapist: `Wallet issues can be frustrating. Take a deep breath ‚Äî we'll get this sorted. üíô`
    },
    scam: {
      keywords: ['scam', 'rug', 'honeypot', 'lost', 'stolen', 'fake', 'fraud'],
      answer: `If you suspect a scam:<br>
        1. ‚ö†Ô∏è <strong>DO NOT</strong> send more funds or sign transactions<br>
        2. Check the token on <a href="tribunal.html">AI Tribunal</a> for risk analysis<br>
        3. Report suspicious activity in the Feed with #ScamAlert<br>
        4. Revoke token approvals at <a href="https://revoke.cash" target="_blank">revoke.cash</a><br><br>
        <strong>Remember:</strong> Never share your seed phrase. Ever.`,
      therapist: `I'm sorry this happened. Losing funds hurts. But you're not alone ‚Äî our community has your back. Let's prevent this for others. ü§ù`
    },
    posts: {
      keywords: ['post', 'delete', 'edit', 'disappeared', 'feed', 'comment'],
      answer: `To manage your content:<br>
        ‚Ä¢ <strong>Delete post:</strong> Go to Feed ‚Üí find your post ‚Üí click üóëÔ∏è<br>
        ‚Ä¢ <strong>Edit:</strong> Not available yet (coming soon)<br>
        ‚Ä¢ <strong>Comment disappeared:</strong> Comments are stored locally; clearing cache removes them<br>
        ‚Ä¢ <strong>Post not visible:</strong> Check if it was flagged by Sentinel AI (risk review)<br><br>
        <strong>Note:</strong> All data is stored in your browser (localStorage) for now.`,
      therapist: `Missing content? That's annoying. Let's make sure your voice is heard next time. ‚ú®`
    },
    tribunal: {
      keywords: ['tribunal', 'analysis', 'token', 'risk', 'verdict', 'scan'],
      answer: `How AI Tribunal works:<br>
        1. Enter a token address or search by name<br>
        2. Our AI agents analyze: contract patterns, liquidity, holder distribution<br>
        3. You get a verdict: TRUST / WATCH / AVOID / BAN<br>
        4. Premium users see detailed risk factors<br><br>
        <strong>Disclaimer:</strong> Tribunal provides analysis, not financial advice. Always DYOR.`,
      therapist: `Analyzing tokens can feel overwhelming. The Tribunal is here to help you make informed decisions. üß†`
    },
    other: {
      keywords: [],
      answer: `I couldn't find an exact match for your question.<br><br>
        Try these:<br>
        ‚Ä¢ <a href="feed.html">Ask in the Feed</a> ‚Äî community might help<br>
        ‚Ä¢ <a href="tribunal.html">Analyze a token</a> ‚Äî if that's your issue<br>
        ‚Ä¢ <strong>Contact admin directly</strong> using the buttons below<br><br>
        <em>Pro tip:</em> Be specific in your question for better answers!`,
      therapist: `Sometimes questions are unique. That's okay ‚Äî let's find the right path together. üó∫Ô∏è`
    }
  };
  
  // === SOUND SYSTEM (UPDATED FILE NAMES) ===
  const HelpSounds = {
    success: new Audio('sounds/coins.mp3'),
    error: new Audio('sounds/gavel.mp3'),
    isMuted: false,
    
    init() {
      this.isMuted = localStorage.getItem('muteAllSounds') === 'true';
      Object.values(this).forEach(s => {
        if (s instanceof Audio) { s.volume = 0.4; s.preload = 'auto'; }
      });
      this.updateIndicator();
    },
    
    play(type) {
      if (this.isMuted) return;
      const sound = this[type];
      if (sound && sound.play) {
        sound.currentTime = 0;
        sound.play().catch(() => {});
      }
    },
    
    updateIndicator() {
      const el = document.getElementById('soundIndicator');
      if (el) el.textContent = `üîä Sounds: ${this.isMuted ? 'OFF' : 'ON'}`;
    }
  };
  
  function escapeHTML(str) {
    if (!str) return '';
    return str.replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]));
  }
  
  function findAnswer(question) {
    const q = question.toLowerCase().trim();
    for (const [category, data] of Object.entries(KNOWLEDGE_BASE)) {
      if (data.keywords.some(k => q.includes(k))) {
        return { ...data, category };
      }
    }
    return { ...KNOWLEDGE_BASE.other, category: 'other' };
  }
  
  function saveToHistory(question, answer, category) {
    const history = JSON.parse(localStorage.getItem('helpHistory')) || [];
    history.unshift({
      question: escapeHTML(question),
      answer: answer.replace(/<br>/g, ' '),
      category,
      timestamp: Date.now()
    });
    localStorage.setItem('helpHistory', JSON.stringify(history.slice(0, 20)));
    renderHistory();
  }
  
  function renderHistory() {
    const list = document.getElementById('faqList');
    const history = JSON.parse(localStorage.getItem('helpHistory')) || [];
    if (!history.length) {
      list.innerHTML = '<p style="color:var(--text-secondary);text-align:center;">No questions yet. Be the first to ask!</p>';
      return;
    }
    list.innerHTML = history.map(item => `
      <div class="faq-item">
        <div class="faq-question">‚ùì ${item.question}</div>
        <div class="faq-answer">üí° ${item.answer.substring(0, 120)}${item.answer.length > 120 ? '...' : ''}</div>
      </div>
    `).join('');
  }
  
  async function askHelp() {
    const input = document.getElementById('helpInput');
    const responseArea = document.getElementById('responseArea');
    const responseContent = document.getElementById('responseContent');
    const question = input.value.trim();
    
    if (!question) {
      showToast('Please describe your issue first', 'error');
      HelpSounds.play('error');
      return;
    }
    
    responseArea.classList.add('visible');
    responseContent.innerHTML = '<div style="color:var(--text-secondary);animation:pulse 1s infinite">ü§ñ Tribunal thinking...</div>';
    
    await new Promise(r => setTimeout(r, 600));
    
    const result = findAnswer(question);
    const therapistMode = /\b(sad|frustrated|angry|lost|help|please)\b/i.test(question);
    
    responseContent.innerHTML = `
      <strong>ü§ñ AI Response:</strong><br><br>
      ${result.answer}
      ${therapistMode && result.therapist ? `<div style="margin-top:1rem;padding-top:1rem;border-top:1px dashed var(--border-color);font-style:italic;color:var(--text-secondary)">${result.therapist}</div>` : ''}
    `;
    
    saveToHistory(question, result.answer, result.category);
    HelpSounds.play(result.category === 'scam' ? 'error' : 'success');
    input.value = '';
  }
  
  function filterCategory(category) {
    document.querySelectorAll('.category-btn').forEach(btn => btn.classList.remove('active'));
    event.target.classList.add('active');
    if (category !== 'all') {
      const example = Object.entries(KNOWLEDGE_BASE).find(([k, v]) => k === category)?.[1]?.keywords?.[0] || '';
      document.getElementById('helpInput').placeholder = `Try asking about ${example}...`;
      document.getElementById('helpInput').focus();
    } else {
      document.getElementById('helpInput').placeholder = "Describe your issue (e.g., 'wallet not connecting', 'post disappeared')...";
    }
  }
  
  function escalate(channel) {
    const question = document.getElementById('helpInput').value || 'General help request';
    
    const actions = {
      email: () => {
        fetch('https://formsubmit.co/ajax/cryptobros.official10@gmail.com', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            subject: 'CryptoBros Help Request',
            message: `Issue: ${question}\n\nSent from Help Desk at ${window.location.href}`,
            _captcha: 'false',
            _next: 'https://cryptobros.pro/help.html?sent=1'
          })
        })
        .then(() => {
          showToast('‚úÖ Message sent! Check your email for reply.', 'success');
          if (typeof HelpSounds !== 'undefined') HelpSounds.play('success');
          document.getElementById('helpInput').value = '';
        })
        .catch(err => {
          console.warn('FormSubmit failed, falling back to mailto:', err);
          window.location.href = `mailto:cryptobros.official10@gmail.com?subject=${encodeURIComponent('CryptoBros Help Request')}&body=${encodeURIComponent(`Issue: ${question}\n\nSent from Help Desk`)}`;
        });
      },
      
      twitter: () => {
        const twitterId = '1766064671757107200';
        const encodedMsg = encodeURIComponent(`@MaxCaneCrypto Help: ${question}`);
        window.open(`https://twitter.com/messages/compose?recipient_id=${twitterId}&text=${encodedMsg}`, '_blank');
        showToast('üê¶ Opening X/Twitter DM...', 'success');
        if (typeof HelpSounds !== 'undefined') HelpSounds.play('success');
      }
    };
    
    if (actions[channel]) actions[channel]();
  }
  
  function showToast(msg, type = 'success') {
    const existing = document.querySelector('.toast');
    if (existing) existing.remove();
    const toast = document.createElement('div');
    toast.className = `toast ${type}`;
    toast.textContent = msg;
    document.body.appendChild(toast);
    setTimeout(() => toast.remove(), 3000);
  }
  
  document.getElementById('helpInput').addEventListener('keypress', e => {
    if (e.key === 'Enter') askHelp();
  });
  
  window.addEventListener('DOMContentLoaded', () => {
    const urlParams = new URLSearchParams(window.location.search);
    if (urlParams.get('sent') === '1') {
      showToast('‚úÖ Your message was sent successfully!', 'success');
      window.history.replaceState({}, document.title, window.location.pathname);
    }
    HelpSounds.init();
    renderHistory();
    window.addEventListener('storage', (e) => {
      if (e.key === 'muteAllSounds') {
        HelpSounds.isMuted = e.newValue === 'true';
        HelpSounds.updateIndicator();
      }
    });
    console.log('ü§ñ Help Desk initialized');
  });
</script>
</body>
</html>
