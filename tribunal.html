<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CRYPTOBROS TRIBUNAL ‚Äî AI Risk Assessment</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;600;700;800;900&family=Inter:wght@300;400;500;600;700&family=Roboto+Mono:wght@400;500&display=swap" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/tsparticles@2.11.0/tsparticles.bundle.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/vanilla-tilt/1.8.0/vanilla-tilt.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html-to-image/1.11.11/html-to-image.min.js"></script>
  <style>
    :root {
      --neon-blue: #0047FF; --neon-cyan: #00F0FF; --neon-green: #00FF9D;
      --neon-gold: #FFD700; --neon-purple: #9D00FF; --neon-red: #FF4D4D;
      --neon-orange: #FF9D00; --deep-bg: #0a0e27; --deep-purple: #1a0b2e;
      --card-bg: rgba(10, 14, 39, 0.7); --glass-border: rgba(255, 255, 255, 0.1);
      --text-primary: #e0e0ff; --text-secondary: #a0a0c0;
      --agent-hunter: #ff4d4d; --agent-oracle: #9d00ff;
      --agent-judge: #00f0ff; --agent-moderator: #ffd700;
      --analysis-intensity: 1;
    }
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: 'Inter', sans-serif; background: var(--deep-bg);
      color: var(--text-primary); min-height: 100vh; overflow-x: hidden;
      position: relative; contain: layout;
    }
    #particles-container {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      z-index: 0; pointer-events: none;
    }
    .container {
      max-width: 1400px; margin: 0 auto; padding: 20px;
      position: relative; z-index: 1;
    }
    .loading-screen {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background: var(--deep-bg); display: flex;
      flex-direction: column; align-items: center; justify-content: center;
      z-index: 10000; visibility: hidden; opacity: 0;
    }
    .loading-screen.active { visibility: visible; opacity: 1; }
    .loading-logo {
      font-family: 'Orbitron', sans-serif; font-size: 3rem; font-weight: 900;
      background: linear-gradient(135deg, var(--neon-cyan), var(--neon-purple));
      -webkit-background-clip: text; -webkit-text-fill-color: transparent;
      background-clip: text; margin-bottom: 2rem; text-align: center;
    }
    .loading-progress {
      width: 300px; height: 4px; background: rgba(255, 255, 255, 0.1);
      border-radius: 2px; overflow: hidden; margin-top: 2rem;
    }
    .loading-bar {
      height: 100%; background: linear-gradient(90deg, var(--neon-cyan), var(--neon-purple));
      width: 0%; transition: width 0.3s ease;
    }
    .loading-text {
      font-family: 'Roboto Mono', monospace; font-size: 0.9rem;
      color: var(--text-secondary); margin-top: 1rem; text-align: center;
    }
    .back-btn {
      position: absolute; top: 20px; left: 20px; padding: 0.7rem 1.4rem;
      background: rgba(10, 14, 39, 0.8); border: 1px solid var(--neon-cyan);
      border-radius: 12px; font-family: 'Orbitron', sans-serif;
      font-weight: 600; font-size: 0.9rem; color: var(--neon-cyan);
      cursor: pointer; transition: all 0.3s ease; text-decoration: none;
      display: inline-flex; align-items: center; gap: 0.5rem;
      backdrop-filter: blur(10px);
    }
    .back-btn:hover {
      background: rgba(0, 240, 255, 0.1);
      box-shadow: 0 0 20px rgba(0, 240, 255, 0.4); transform: translateX(-4px);
    }
    .header { text-align: center; padding: 3rem 0; margin-bottom: 2rem; }
    .main-title {
      font-family: 'Orbitron', sans-serif; font-size: 3rem; font-weight: 900;
      background: linear-gradient(135deg, var(--neon-cyan), var(--neon-purple), var(--neon-blue));
      background-size: 200% 200%; -webkit-background-clip: text;
      -webkit-text-fill-color: transparent; background-clip: text;
      animation: gradientFlow 5s ease infinite; margin-bottom: 0.5rem;
      text-shadow: 0 0 40px rgba(0, 240, 255, 0.5);
    }
    @keyframes gradientFlow { 0%, 100% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } }
    .subtitle {
      font-family: 'Roboto Mono', monospace; font-size: 1rem;
      color: var(--text-secondary); margin-bottom: 1.5rem; letter-spacing: 2px;
    }
    .warning-text {
      font-family: 'Orbitron', sans-serif; font-size: 1.1rem; font-weight: 700;
      color: var(--neon-red); text-shadow: 0 0 20px rgba(255, 77, 77, 0.8);
      animation: warningPulse 2s ease-in-out infinite;
    }
    @keyframes warningPulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.7; } }
    .search-section {
      background: var(--card-bg); border: 1px solid var(--glass-border);
      border-radius: 20px; padding: 2rem; margin-bottom: 2rem;
      backdrop-filter: blur(12px); box-shadow: 0 0 40px rgba(0, 71, 255, 0.2);
    }
    .search-input-wrapper { display: flex; gap: 1rem; margin-bottom: 1rem; }
    .search-input {
      flex: 1; padding: 1rem 1.5rem; background: rgba(10, 14, 39, 0.5);
      border: 2px solid var(--glass-border); border-radius: 12px;
      font-family: 'Roboto Mono', monospace; font-size: 1rem;
      color: var(--text-primary); transition: all 0.3s ease;
    }
    .search-input:focus {
      outline: none; border-color: var(--neon-cyan);
      box-shadow: 0 0 20px rgba(0, 240, 255, 0.3);
    }
    .analyze-btn {
      padding: 1rem 2.5rem; background: linear-gradient(135deg, var(--neon-cyan), var(--neon-blue));
      border: none; border-radius: 12px; font-family: 'Orbitron', sans-serif;
      font-weight: 700; font-size: 1rem; color: var(--deep-bg);
      cursor: pointer; transition: all 0.3s ease; white-space: nowrap;
    }
    .analyze-btn:hover { transform: translateY(-2px); box-shadow: 0 0 30px rgba(0, 240, 255, 0.6); }
    .analyze-btn:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }
    .quick-tokens { display: flex; gap: 0.5rem; flex-wrap: wrap; justify-content: center; }
    .token-chip {
      padding: 0.5rem 1rem; background: rgba(0, 240, 255, 0.1);
      border: 1px solid var(--neon-cyan); border-radius: 20px;
      font-family: 'Roboto Mono', monospace; font-size: 0.85rem;
      color: var(--neon-cyan); cursor: pointer; transition: all 0.3s ease;
    }
    .token-chip:hover { background: rgba(0, 240, 255, 0.2); transform: scale(1.05); }
    .tribunal-section {
      background: var(--card-bg); border: 1px solid var(--glass-border);
      border-radius: 20px; padding: 2rem; margin-bottom: 2rem;
      backdrop-filter: blur(12px);
    }
    .section-title {
      font-family: 'Orbitron', sans-serif; font-size: 1.5rem; font-weight: 700;
      color: var(--neon-cyan); text-align: center; margin-bottom: 2rem;
      text-transform: uppercase; letter-spacing: 2px;
    }
    .agent-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1.5rem; }
    .agent-card {
      background: rgba(10, 14, 39, 0.5); border: 1px solid var(--glass-border);
      border-radius: 16px; padding: 1.5rem; position: relative;
      overflow: hidden; contain: layout style paint; transition: all 0.3s ease;
    }
    .agent-card:hover { transform: translateY(-4px); border-color: var(--agent-hunter); box-shadow: 0 0 30px rgba(255, 77, 77, 0.3); }
    .agent-card[data-agent="oracle"]:hover { border-color: var(--agent-oracle); box-shadow: 0 0 30px rgba(157, 0, 255, 0.3); }
    .agent-card[data-agent="judge"]:hover { border-color: var(--agent-judge); box-shadow: 0 0 30px rgba(0, 240, 255, 0.3); }
    .agent-card[data-agent="moderator"]:hover { border-color: var(--agent-moderator); box-shadow: 0 0 30px rgba(255, 215, 0, 0.3); }
    .agent-header { display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem; }
    .agent-core { width: 64px; height: 64px; position: relative; flex-shrink: 0; filter: drop-shadow(0 0 15px currentColor); }
    .core-svg { width: 100%; height: 100%; }
    .agent-info { flex: 1; }
    .agent-name { font-family: 'Orbitron', sans-serif; font-size: 0.95rem; font-weight: 700; color: var(--text-primary); margin-bottom: 0.25rem; }
    .agent-model { font-family: 'Roboto Mono', monospace; font-size: 0.75rem; color: var(--text-secondary); margin-bottom: 0.5rem; }
    .agent-status {
      font-family: 'Roboto Mono', monospace; font-size: 0.7rem;
      padding: 0.25rem 0.5rem; border-radius: 4px; display: inline-block;
      background: rgba(0, 240, 255, 0.1); color: var(--neon-cyan);
      border: 1px solid var(--neon-cyan);
    }
    .agent-status.analyzing {
      background: rgba(255, 215, 0, 0.1); color: var(--neon-gold);
      border-color: var(--neon-gold); animation: statusPulse 1s ease-in-out infinite;
    }
    @keyframes statusPulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.6; } }
    .agent-output { font-family: 'Roboto Mono', monospace; font-size: 0.8rem; color: var(--text-secondary); line-height: 1.6; }
    .agent-output li { list-style: none; margin-bottom: 0.3rem; padding-left: 1rem; position: relative; }
    .agent-output li::before { content: '‚Üí'; position: absolute; left: 0; color: var(--neon-cyan); }
    .core-ring { fill: none; stroke: currentColor; stroke-width: 2.5; stroke-opacity: 0.6; animation: corePulse calc(4s / var(--analysis-intensity, 1)) ease-in-out infinite; }
    .core-ring-outer { animation-delay: 0s; }
    .core-ring-inner { animation-delay: 0.5s; }
    @keyframes corePulse { 0%, 100% { stroke-opacity: 0.6; transform: scale(1); } 50% { stroke-opacity: 1; transform: scale(1.05); } }
    .crosshair { fill: none; stroke: currentColor; stroke-width: 2; animation: crosshairScan calc(3s / var(--analysis-intensity, 1)) linear infinite; transform-origin: center; }
    @keyframes crosshairScan { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
    .orbital-ring { fill: none; stroke: currentColor; stroke-width: 2; stroke-dasharray: 10 5; animation: orbitalRotate calc(8s / var(--analysis-intensity, 1)) linear infinite; }
    @keyframes orbitalRotate { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
    .candlestick { fill: currentColor; stroke: currentColor; stroke-width: 1; opacity: 0.8; }
    .balance-line { fill: none; stroke: currentColor; stroke-width: 2; animation: balanceTilt calc(4s / var(--analysis-intensity, 1)) ease-in-out infinite; transform-origin: center; }
    @keyframes balanceTilt { 0%, 100% { transform: rotate(-3deg); } 50% { transform: rotate(3deg); } }
    .verdict-section {
      background: var(--card-bg); border: 2px solid var(--glass-border);
      border-radius: 20px; padding: 3rem 2rem; margin-bottom: 2rem;
      backdrop-filter: blur(12px); text-align: center; position: relative; overflow: hidden;
    }
    .verdict-section.high-risk { border-color: var(--neon-red); box-shadow: 0 0 60px rgba(255, 77, 77, 0.3); }
    .verdict-section.low-risk { border-color: var(--neon-green); box-shadow: 0 0 60px rgba(0, 255, 157, 0.3); }
    .verdict-title { font-family: 'Orbitron', sans-serif; font-size: 1.5rem; font-weight: 700; color: var(--neon-cyan); margin-bottom: 1.5rem; text-transform: uppercase; letter-spacing: 2px; }
    .verdict-score { font-family: 'Orbitron', sans-serif; font-size: 4rem; font-weight: 900; margin-bottom: 1rem; text-shadow: 0 0 40px currentColor; }
    .verdict-score.high-risk { color: var(--neon-red); }
    .verdict-score.low-risk { color: var(--neon-green); }
    .verdict-label { font-family: 'Orbitron', sans-serif; font-size: 2rem; font-weight: 800; margin-bottom: 2rem; text-transform: uppercase; }
    .verdict-label.high-risk { color: var(--neon-red); text-shadow: 0 0 30px rgba(255, 77, 77, 0.8); animation: glitchText 0.3s ease-in-out; }
    .verdict-label.low-risk { color: var(--neon-green); text-shadow: 0 0 30px rgba(0, 255, 157, 0.8); }
    @keyframes glitchText { 0%, 100% { transform: translate(0); } 25% { transform: translate(-2px, 2px); } 50% { transform: translate(2px, -2px); } 75% { transform: translate(-2px, -2px); } }
    .quantum-scan { font-family: 'Roboto Mono', monospace; font-size: 0.85rem; color: var(--text-secondary); margin-bottom: 2rem; display: flex; align-items: center; justify-content: center; gap: 0.5rem; }
    .scan-indicator { width: 8px; height: 8px; background: var(--neon-cyan); border-radius: 50%; animation: scanBlink 1s ease-in-out infinite; }
    @keyframes scanBlink { 0%, 100% { opacity: 1; } 50% { opacity: 0.3; } }
    .save-verdict-btn {
      padding: 1rem 3rem; background: linear-gradient(135deg, var(--neon-purple), var(--neon-cyan));
      border: none; border-radius: 12px; font-family: 'Orbitron', sans-serif;
      font-weight: 700; font-size: 1rem; color: var(--deep-bg);
      cursor: pointer; transition: all 0.3s ease; box-shadow: 0 0 30px rgba(157, 0, 255, 0.4);
    }
    .save-verdict-btn:hover { transform: translateY(-3px); box-shadow: 0 0 50px rgba(157, 0, 255, 0.7); }
    .shockwave {
      position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
      width: 10px; height: 10px; border-radius: 50%;
      background: radial-gradient(circle, rgba(255,255,255,0.8) 0%, transparent 70%);
      pointer-events: none; z-index: 9999; opacity: 0;
    }
    .shockwave.animate { animation: shockwaveExpand 1s ease-out forwards; }
    @keyframes shockwaveExpand { 0% { width: 10px; height: 10px; opacity: 1; } 100% { width: 3000px; height: 3000px; opacity: 0; } }
    .sound-toggle {
      position: fixed; bottom: 30px; right: 30px; width: 48px; height: 48px;
      background: var(--card-bg); border: 1px solid var(--glass-border);
      border-radius: 50%; display: flex; align-items: center; justify-content: center;
      cursor: pointer; font-size: 1.5rem; backdrop-filter: blur(10px);
      transition: all 0.3s ease; z-index: 1000;
    }
    .sound-toggle:hover { border-color: var(--neon-cyan); box-shadow: 0 0 20px rgba(0, 240, 255, 0.4); transform: scale(1.1); }
    .loading-spinner {
      display: inline-block; width: 20px; height: 20px;
      border: 3px solid rgba(0, 240, 255, 0.3); border-top-color: var(--neon-cyan);
      border-radius: 50%; animation: spin 1s linear infinite; margin-right: 10px;
    }
    @keyframes spin { to { transform: rotate(360deg); } }
    @media (max-width: 768px) {
      .main-title { font-size: 2rem; }
      .search-input-wrapper { flex-direction: column; }
      .analyze-btn { width: 100%; }
      .agent-grid { grid-template-columns: 1fr; }
      .verdict-score { font-size: 2.5rem; }
      .verdict-label { font-size: 1.5rem; }
      .back-btn { position: relative; top: auto; left: auto; margin-bottom: 1rem; }
      .header { padding: 2rem 0; }
      .sound-toggle { bottom: 20px; right: 20px; width: 42px; height: 42px; }
    }
    @media (prefers-reduced-motion: reduce) {
      *, *::before, *::after { animation-duration: 0.01ms !important; animation-iteration-count: 1 !important; transition-duration: 0.01ms !important; }
    }
  </style>
</head>
<body>
  <div class="loading-screen" id="loadingScreen">
    <div class="loading-logo">CRYPTOBROS TRIBUNAL</div>
    <div class="loading-progress"><div class="loading-bar" id="loadingBar"></div></div>
    <div class="loading-text" id="loadingText">Initializing AI agents...</div>
  </div>
  <div class="shockwave" id="shockwave"></div>
  <div id="particles-container"></div>
  <div class="container">
    <a href="index.html" class="back-btn">‚Ü© Back to Home</a>
    <div class="header">
      <h1 class="main-title">CRYPTOBROS TRIBUNAL</h1>
      <p class="subtitle">AI Multi-Agent Risk Assessment System</p>
      <p class="warning-text">We do not recommend buying! We advise NOT to buy!</p>
    </div>
    <div class="search-section">
      <div class="search-input-wrapper">
        <input type="text" class="search-input" id="tokenInput" placeholder="Enter token address or symbol (e.g., $WIF, $BONK)...">
        <button class="analyze-btn" id="analyzeBtn" onclick="analyzeToken()">ANALYZE</button>
      </div>
      <div class="quick-tokens">
        <span class="token-chip" onclick="quickAnalyze('$WIF')">$WIF</span>
        <span class="token-chip" onclick="quickAnalyze('$BONK')">$BONK</span>
        <span class="token-chip" onclick="quickAnalyze('$SOL')">$SOL</span>
        <span class="token-chip" onclick="quickAnalyze('$AUS')">$AUS</span>
        <span class="token-chip" onclick="quickAnalyze('$DOG (meme)')">$DOG (meme)</span>
      </div>
    </div>
    <div class="tribunal-section">
      <h2 class="section-title">Tribunal Deliberation</h2>
      <div class="agent-grid">
        <div class="agent-card" data-agent="hunter" data-status="idle">
          <div class="agent-header">
            <div class="agent-core" style="color: var(--agent-hunter);">
              <svg viewBox="0 0 100 100" class="core-svg">
                <circle class="core-ring core-ring-outer" cx="50" cy="50" r="38"/>
                <circle class="core-ring core-ring-inner" cx="50" cy="50" r="28"/>
                <path class="crosshair" d="M50 15 L50 85 M15 50 L85 50"/>
              </svg>
            </div>
            <div class="agent-info">
              <div class="agent-name">Phi-3-mini On-Chain Hunter</div>
              <div class="agent-model">3.8B parameters ‚Ä¢ 128K context</div>
              <div class="agent-status" id="hunter-status">ONLINE</div>
            </div>
          </div>
          <ul class="agent-output" id="hunter-output"><li>Scanning blockchain data...</li></ul>
        </div>
        <div class="agent-card" data-agent="oracle" data-status="idle">
          <div class="agent-header">
            <div class="agent-core" style="color: var(--agent-oracle);">
              <svg viewBox="0 0 100 100" class="core-svg">
                <circle class="core-ring core-ring-outer" cx="50" cy="50" r="38"/>
                <circle class="orbital-ring" cx="50" cy="50" r="25"/>
                <circle class="core-ring core-ring-inner" cx="50" cy="50" r="15"/>
              </svg>
            </div>
            <div class="agent-info">
              <div class="agent-name">Qwen1.5 Sentiment Oracle</div>
              <div class="agent-model">7B parameters ‚Ä¢ Multilingual</div>
              <div class="agent-status" id="oracle-status">ONLINE</div>
            </div>
            <ul class="agent-output" id="oracle-output"><li>Monitoring social signals...</li></ul>
          </div>
        </div>
        <div class="agent-card" data-agent="judge" data-status="idle">
          <div class="agent-header">
            <div class="agent-core" style="color: var(--agent-judge);">
              <svg viewBox="0 0 100 100" class="core-svg">
                <circle class="core-ring core-ring-outer" cx="50" cy="50" r="38"/>
                <rect class="candlestick" x="35" y="30" width="8" height="25"/>
                <rect class="candlestick" x="48" y="25" width="8" height="35"/>
                <rect class="candlestick" x="61" y="35" width="8" height="20"/>
                <line class="candlestick" x1="39" y1="25" x2="39" y2="60"/>
                <line class="candlestick" x1="52" y1="20" x2="52" y2="65"/>
                <line class="candlestick" x1="65" y1="30" x2="65" y2="60"/>
              </svg>
            </div>
            <div class="agent-info">
              <div class="agent-name">DeepSeek Price Action Judge</div>
              <div class="agent-model">67B parameters ‚Ä¢ Financial training</div>
              <div class="agent-status" id="judge-status">ONLINE</div>
            </div>
            <ul class="agent-output" id="judge-output"><li>Analyzing price patterns...</li></ul>
          </div>
        </div>
        <div class="agent-card" data-agent="moderator" data-status="idle">
          <div class="agent-header">
            <div class="agent-core" style="color: var(--agent-moderator);">
              <svg viewBox="0 0 100 100" class="core-svg">
                <circle class="core-ring core-ring-outer" cx="50" cy="50" r="38"/>
                <line class="balance-line" x1="20" y1="50" x2="80" y2="50"/>
                <circle class="core-ring core-ring-inner" cx="50" cy="50" r="12"/>
                <line class="balance-line" x1="50" y1="35" x2="50" y2="65"/>
              </svg>
            </div>
            <div class="agent-info">
              <div class="agent-name">Phi-3-mini Moderator</div>
              <div class="agent-model">3.8B parameters ‚Ä¢ Consensus engine</div>
              <div class="agent-status" id="moderator-status">ONLINE</div>
            </div>
            <ul class="agent-output" id="moderator-output"><li>Synthesizing verdict...</li></ul>
          </div>
        </div>
      </div>
    </div>
    <div class="verdict-section" id="verdictSection">
      <h2 class="verdict-title">Final Verdict</h2>
      <div class="verdict-score high-risk" id="verdictScore">0.90</div>
      <div class="verdict-label high-risk" id="verdictLabel">HIGH RISK</div>
      <div class="quantum-scan"><div class="scan-indicator"></div><span>Initiating Quantum Contract Scan...</span></div>
      <button class="save-verdict-btn" onclick="saveVerdict()">üíæ SAVE VERDICT</button>
    </div>
  </div>
  <div class="sound-toggle" id="soundToggle" onclick="toggleSound()" title="Toggle Sound">üîá</div>
  <script>
    // CONFIG
    const CONFIG = {
      soundsEnabled: false,
      isMobile: window.innerWidth < 768,
      loadTime: null
    };
    CONFIG.loadTime = CONFIG.isMobile ? 4500 : 6500;

    // SOUND SYSTEM
    const SoundSystem = {
      ctx: null,
      async init() {
        if (!CONFIG.soundsEnabled) return;
        try { this.ctx = new (window.AudioContext || window.webkitAudioContext)(); }
        catch(e) { console.warn('Web Audio API not supported'); }
      },
      toggle() {
        CONFIG.soundsEnabled = !CONFIG.soundsEnabled;
        try { localStorage.setItem('tribunalSounds', CONFIG.soundsEnabled ? 'true' : 'false'); } catch(e) {}
        document.getElementById('soundToggle').textContent = CONFIG.soundsEnabled ? 'üîä' : 'üîá';
      }
    };

    // PARTICLES
    async function initParticles() {
      if (CONFIG.isMobile) return;
      try {
        await tsParticles.load("particles-container", {
          particles: {
            number: { value: 60 }, color: { value: ["#0047FF", "#00F0FF", "#9D00FF"] },
            shape: { type: "circle" }, opacity: { value: 0.3, random: true },
            size: { value: 2, random: true },
            move: { enable: true, speed: 0.5, direction: "none", random: true, out_mode: "out" },
            links: { enable: true, distance: 150, color: "#0047FF", opacity: 0.2, width: 1 }
          },
          interactivity: { detect_on: "canvas", events: { onhover: { enable: false }, onclick: { enable: false } } },
          retina_detect: true
        });
      } catch(e) { console.warn('Particles init failed'); }
    }

    // LOADING SEQUENCE
    async function runLoadingSequence() {
      const screen = document.getElementById('loadingScreen');
      const bar = document.getElementById('loadingBar');
      const text = document.getElementById('loadingText');
      screen.classList.add('active');
      const tl = gsap.timeline();
      tl.to(screen, { opacity: 1, duration: 0.5 });
      tl.to('.loading-logo', { textShadow: '2px 0 var(--neon-red), -2px 0 var(--neon-cyan)', duration: 0.3, repeat: 3, yoyo: true });
      tl.to(bar, { width: '100%', duration: 4, ease: 'power2.inOut' }, '-=0.5');
      const texts = ['Initializing AI agents...', 'Activating Phi-3-mini Hunter...', 'Activating Qwen1.5 Oracle...', 'Activating DeepSeek Judge...', 'Activating Phi-3-mini Moderator...', 'Neural network online...', 'Ready for Judgment'];
      texts.forEach((txt, i) => {
        tl.to(text, { opacity: 0, duration: 0.2, onComplete: () => { text.textContent = txt; } }, i * 0.6);
        tl.to(text, { opacity: 1, duration: 0.2 }, i * 0.6 + 0.2);
      });
      tl.to(screen, { opacity: 0, duration: 0.5, onComplete: () => { screen.classList.remove('active'); screen.style.display = 'none'; } }, '-=0.5');
      tl.call(() => revealVerdict(), null, '-=0.3');
    }

    // VERDICT REVEAL
    function revealVerdict() {
      const shockwave = document.getElementById('shockwave');
      const verdictSection = document.getElementById('verdictSection');
      const scoreEl = document.getElementById('verdictScore');
      shockwave.classList.add('animate');
      setTimeout(() => shockwave.classList.remove('animate'), 1000);
      gsap.to({val: 0}, {val: 0.90, duration: 2, ease: 'power2.out', onUpdate: function() { scoreEl.textContent = this.targets()[0].val.toFixed(2); }});
      gsap.fromTo(verdictSection, { boxShadow: '0 0 0 rgba(255, 77, 77, 0)' }, { boxShadow: '0 0 60px rgba(255, 77, 77, 0.3)', duration: 1 });
    }

    // UTILS
    function safeGet(key, defaultVal) { try { const val = localStorage.getItem(key); return val === null ? defaultVal : (typeof defaultVal === 'string' ? val : JSON.parse(val)); } catch(e) { return defaultVal; } }
    function safeSet(key, val) { try { localStorage.setItem(key, typeof val === 'string' ? val : JSON.stringify(val)); } catch(e) { console.warn('localStorage failed'); } }
    function delay(ms) { return new Promise(resolve => setTimeout(resolve, ms)); }
    function formatNumber(num) { if (num >= 1e9) return (num/1e9).toFixed(2)+'B'; if (num >= 1e6) return (num/1e6).toFixed(2)+'M'; if (num >= 1e3) return (num/1e3).toFixed(2)+'K'; return num.toFixed(2); }

    // ANALYSIS FUNCTIONS (from old code, fixed)
    async function fetchTokenData(query) {
      try {
        const response = await fetch(`https://api.dexscreener.com/latest/dex/search?q=${encodeURIComponent(query)}`);
        if (!response.ok) return { offlineMode: true, tokenData: null };
        const data = await response.json();
        if (!data.pairs || data.pairs.length === 0) return { offlineMode: true, tokenData: null };
        const tokenData = data.pairs.reduce((best, current) => (current.liquidity?.usd || 0) > (best.liquidity?.usd || 0) ? current : best);
        return { offlineMode: false, tokenData };
      } catch(e) { console.log('DexScreener API error:', e); return { offlineMode: true, tokenData: null }; }
    }

    function analyzeOnChain(tokenQuery, tokenData, offlineMode) {
      if (offlineMode || !tokenData) return { output: "‚Üí Contract verification: FAILED\n‚Üí No on-chain data available\n‚Üí ‚ö†Ô∏è EXTREME RISK: Unknown contract", risk: 0.95, factors: ['No data available', 'Unknown contract'] };
      const baseToken = tokenData.baseToken || {};
      const liquidity = tokenData.liquidity || {};
      const fdv = tokenData.fdv || 0;
      const pairCreatedAt = tokenData.pairCreatedAt || 0;
      let output = "‚Üí On-chain analysis complete\n";
      let risk = 0.5, factors = [];
      if (tokenQuery.toLowerCase().includes('aus') || tokenQuery.toLowerCase().includes('auraspace')) return { output: "‚Üí AURASPACE token detected\n‚Üí Native to CRYPTOBROS ecosystem\n‚Üí Contract verified and trusted\n‚Üí LP locked permanently", risk: 0.05, factors: ['Verified contract', 'Ecosystem token', 'LP locked'] };
      const ticker = (tokenData.baseToken?.symbol || '').toLowerCase();
      const blueChips = ['sol','eth','btc','usdt','usdc','xrp','ada','dot','avax','matic'];
      if (blueChips.some(chip => ticker.includes(chip))) return { output: "‚Üí Blue chip asset detected\n‚Üí Established contract\n‚Üí High liquidity pool\n‚Üí Verified on-chain", risk: 0.15, factors: ['Blue chip asset', 'Established contract', 'High liquidity'] };
      const ageHours = (Date.now() - (pairCreatedAt * 1000)) / (1000 * 60 * 60);
      if (ageHours < 1) { output += "‚Üí ‚ö†Ô∏è NEW CONTRACT (<1h old)\n"; risk += 0.3; factors.push('Brand new contract'); }
      else if (ageHours < 24) { output += `‚Üí Young contract (${ageHours.toFixed(1)}h old)\n`; risk += 0.2; factors.push('New contract'); }
      if (liquidity.usd && liquidity.usd < 50000) { output += `‚Üí ‚ö†Ô∏è CRITICAL: Low liquidity $${formatNumber(liquidity.usd)}\n`; risk += 0.3; factors.push('Low liquidity < $50k'); }
      else if (liquidity.usd && liquidity.usd < 200000) { output += `‚Üí ‚ö†Ô∏è Low liquidity $${formatNumber(liquidity.usd)}\n`; risk += 0.2; factors.push('Low liquidity < $200k'); }
      if (fdv > 0 && fdv < 100000) { output += `‚Üí ‚ö†Ô∏è Micro-cap FDV: $${formatNumber(fdv)}\n`; risk += 0.15; factors.push('Micro-cap FDV'); }
      output += `‚Üí Contract: ${baseToken.address?.substring(0, 12)}...\n‚Üí DEX: ${tokenData.dexId || 'Unknown'}\n‚Üí Chain: ${tokenData.chainId || 'Unknown'}\n`;
      return { output, risk: Math.min(0.99, risk), factors };
    }

    function analyzeSentiment(tokenQuery, tokenData, offlineMode) {
      if (offlineMode || !tokenData) return { output: "‚Üí Social sentiment: UNKNOWN\n‚Üí No market data available\n‚Üí ‚ö†Ô∏è Cannot assess community trust", risk: 0.85, factors: ['No sentiment data', 'Unknown community'] };
      const volume = tokenData.volume || {};
      const priceChange = tokenData.priceChange || {};
      const txns = tokenData.txns || {};
      let output = "‚Üí Social sentiment analysis\n";
      let risk = 0.5, factors = [];
      if (tokenQuery.toLowerCase().includes('aus') || tokenQuery.toLowerCase().includes('auraspace')) return { output: "‚Üí Positive community sentiment\n‚Üí Strong ecosystem support\n‚Üí Growing adoption in CRYPTOBROS network\n‚Üí Active developer engagement", risk: 0.1, factors: ['Strong community', 'Ecosystem support'] };
      const ticker = (tokenData.baseToken?.symbol || '').toLowerCase();
      const blueChips = ['sol','eth','btc','usdt','usdc'];
      if (blueChips.some(chip => ticker.includes(chip))) return { output: "‚Üí Strong community trust\n‚Üí Established reputation\n‚Üí Low social manipulation risk\n‚Üí Organic growth", risk: 0.15, factors: ['Established reputation', 'Strong trust'] };
      if (volume.h24) {
        if (volume.h24 > 1e7) output += `‚Üí üî• HIGH VOLUME: $${formatNumber(volume.h24)} (24h)\n‚Üí Strong social buzz\n`;
        else if (volume.h24 < 1e5) { output += `‚Üí Low volume: $${formatNumber(volume.h24)} (24h)\n‚Üí Weak community engagement\n`; risk += 0.1; factors.push('Low social engagement'); }
      }
      if (txns.h24?.buys && txns.h24?.sells) {
        const ratio = txns.h24.buys / (txns.h24.buys + txns.h24.sells);
        if (ratio > 0.85) { risk += 0.2; factors.push('Extreme FOMO'); }
      }
      if (priceChange.h24) {
        const change = parseFloat(priceChange.h24);
        if (change > 50) { output += `‚Üí üöÄ Extreme bullish momentum +${change.toFixed(1)}% (24h)\n‚Üí Potential pump hype\n`; risk += 0.25; factors.push('Potential pump hype'); }
        else if (change < -30) { output += `‚Üí üìâ Heavy selling pressure ${change.toFixed(1)}% (24h)\n‚Üí Community panic\n`; risk += 0.2; factors.push('Community panic'); }
      }
      const memePatterns = ['wif','bonk','pepe','mog','turbo','dog','shib','floki'];
      if (memePatterns.some(p => ticker.includes(p))) { output += "‚Üí üê∏ Meme coin detected\n‚Üí High social media hype\n‚Üí Extreme volatility expected\n‚Üí Pump & dump risk HIGH"; risk += 0.35; factors.push('Meme coin - high manipulation risk'); }
      return { output, risk: Math.min(0.99, risk), factors };
    }

    function analyzePrice(tokenQuery, tokenData, offlineMode) {
      if (offlineMode || !tokenData) return { output: "‚Üí Price action: UNKNOWN\n‚Üí No trading history available\n‚Üí ‚ö†Ô∏è Cannot assess price stability", risk: 0.9, factors: ['No price data', 'Unknown market behavior'] };
      const liquidity = tokenData.liquidity || {};
      const volume = tokenData.volume || {};
      const priceChange = tokenData.priceChange || {};
      const fdv = tokenData.fdv || 0;
      let output = "‚Üí Price action analysis\n";
      let risk = 0.5, factors = [];
      const ticker = (tokenData.baseToken?.symbol || '').toLowerCase();
      const blueChips = ['sol','eth','btc','usdt','usdc','xrp','ada','dot','avax','matic'];
      if (blueChips.some(chip => ticker.includes(chip))) return { output: "‚Üí Blue chip asset\n‚Üí High liquidity and volume\n‚Üí Established market presence\n‚Üí Low volatility profile\n‚Üí Stable price action", risk: 0.1, factors: ['Blue chip', 'Low volatility', 'Stable price'] };
      if (tokenQuery.toLowerCase().includes('aus') || tokenQuery.toLowerCase().includes('auraspace')) return { output: "‚Üí Stable price action\n‚Üí Healthy trading volume\n‚Üí Sustainable growth pattern\n‚Üí Ecosystem-backed token\n‚Üí Low manipulation risk", risk: 0.1, factors: ['Stable price', 'Ecosystem-backed'] };
      if (liquidity.usd && volume.h24) {
        const ratio = volume.h24 / liquidity.usd;
        if (ratio > 10) { output += `‚Üí ‚ö†Ô∏è PUMP ALERT: Volume/Liq ratio ${(ratio.toFixed(1))}x\n‚Üí Extreme price volatility likely\n‚Üí Whale manipulation detected\n`; risk += 0.35; factors.push('Extreme pump pattern (V/L > 10x)'); }
        else if (ratio > 5) { output += `‚Üí High activity: Volume/Liq ratio ${(ratio.toFixed(1))}x\n‚Üí Active trading, monitor closely\n‚Üí Potential manipulation\n`; risk += 0.25; factors.push('High pump risk (V/L > 5x)'); }
      }
      if (fdv > 0 && liquidity.usd > 0) {
        const fdvLiqRatio = fdv / liquidity.usd;
        if (fdvLiqRatio > 100) { output += `‚Üí ‚ö†Ô∏è CRITICAL: FDV/LP ratio ${fdvLiqRatio.toFixed(0)}x\n‚Üí Extreme rug pull risk\n‚Üí Insufficient liquidity backing\n`; risk += 0.3; factors.push('High rug pull risk (FDV/LP > 100x)'); }
      }
      if (priceChange.h6 && priceChange.h24) {
        const h6 = parseFloat(priceChange.h6), h24 = parseFloat(priceChange.h24);
        if (h6 > 30 && h24 < 10) { output += "‚Üí ‚ö†Ô∏è SUSPICIOUS PATTERN DETECTED\n‚Üí Rapid pump followed by dump\n‚Üí Whale manipulation likely\n‚Üí High manipulation risk\n"; risk += 0.3; factors.push('Pump and dump pattern'); }
      }
      return { output, risk: Math.min(0.99, risk), factors };
    }

    function analyzeDiscrepancies(analyses) {
      const { onChain, sentiment, price } = analyses;
      let output = "‚ö†Ô∏è CONSENSUS VERDICT\n";
      let riskFactors = [], contradictions = [];
      if (onChain.risk === 0.05) return { output: "‚Üí TOKEN VERIFIED AS TRUSTED\n‚Üí Native to CRYPTOBROS ecosystem\n‚Üí Maximum security and transparency\n‚Üí All experts concur: LOW RISK\n‚Üí Risk Score: 0.05/1.00", risk: 0.05, category: 'trusted', recommendation: 'TRUST', factors: ['Native CRYPTOBROS ecosystem token'] };
      if (Math.abs(onChain.risk - sentiment.risk) > 0.4) contradictions.push("‚ö†Ô∏è ON-CHAIN vs SENTIMENT DISCREPANCY");
      if (Math.abs(sentiment.risk - price.risk) > 0.4) contradictions.push("‚ö†Ô∏è SENTIMENT vs PRICE ACTION DISCREPANCY");
      if (Math.abs(onChain.risk - price.risk) > 0.4) contradictions.push("‚ö†Ô∏è ON-CHAIN vs PRICE DISCREPANCY");
      let baseRisk = (onChain.risk + sentiment.risk + price.risk) / 3;
      if (contradictions.length > 0) { baseRisk += 0.15 * contradictions.length; riskFactors.push('Expert disagreement - high uncertainty'); }
      let finalRisk = Math.min(0.99, Math.max(0.05, baseRisk));
      let category, recommendation;
      if (finalRisk < 0.3) { category = 'low'; recommendation = 'TRUST'; output += "\n‚Üí RECOMMENDATION: TRUST\n‚Üí Suitable for investment\n‚Üí Strong fundamentals across all metrics"; }
      else if (finalRisk < 0.7) { category = 'medium'; recommendation = 'WATCH'; output += "\n‚Üí RECOMMENDATION: WATCH\n‚Üí Moderate risk detected\n‚Üí DYOR before investing"; }
      else { category = 'high'; recommendation = 'AVOID'; output += "\n‚Üí RECOMMENDATION: AVOID\n‚Üí Multiple red flags detected\n‚Üí Extreme caution advised"; }
      [onChain.factors, sentiment.factors, price.factors].flat().forEach(f => { if (!riskFactors.includes(f)) riskFactors.push(f); });
      output += `\n‚Üí Risk Score: ${finalRisk.toFixed(2)}/1.00`;
      return { output, risk: parseFloat(finalRisk.toFixed(2)), category, recommendation, factors: riskFactors };
    }

    // MAIN ANALYZE
    async function analyzeToken() {
      const input = document.getElementById('tokenInput');
      const btn = document.getElementById('analyzeBtn');
      const token = input.value.trim() || '$WIF';
      if (!token) return;
      btn.disabled = true;
      btn.innerHTML = '<span class="loading-spinner"></span>ANALYZING...';
      document.getElementById('verdictSection').style.display = 'none';
      const { offlineMode, tokenData } = await fetchTokenData(token);
      if (offlineMode) { /* show offline warning if needed */ }
      const agents = [
        { id: 'hunter', name: 'Phi-3-mini On-Chain Hunter', fn: () => analyzeOnChain(token, tokenData, offlineMode) },
        { id: 'oracle', name: 'Qwen1.5 Sentiment Oracle', fn: () => analyzeSentiment(token, tokenData, offlineMode) },
        { id: 'judge', name: 'DeepSeek Price Action Judge', fn: () => analyzePrice(token, tokenData, offlineMode) }
      ];
      const results = {};
      for (const agent of agents) {
        const statusEl = document.getElementById(`${agent.id}-status`);
        const outputEl = document.getElementById(`${agent.output || agent.id}-output`);
        statusEl.textContent = 'ANALYZING...';
        statusEl.classList.add('analyzing');
        await delay(800);
        const result = agent.fn();
        results[agent.id] = result;
        outputEl.innerHTML = result.output.split('\n').map(l => `<li>${l}</li>`).join('');
        statusEl.textContent = 'COMPLETE';
        statusEl.classList.remove('analyzing');
      }
      // Moderator
      const modStatus = document.getElementById('moderator-status');
      const modOutput = document.getElementById('moderator-output');
      modStatus.textContent = 'ANALYZING...';
      modStatus.classList.add('analyzing');
      await delay(600);
      const moderator = analyzeDiscrepancies(results);
      modOutput.innerHTML = moderator.output.split('\n').map(l => `<li>${l}</li>`).join('');
      modStatus.textContent = 'COMPLETE';
      modStatus.classList.remove('analyzing');
      // Show verdict
      showVerdict(moderator, token);
      btn.disabled = false;
      btn.textContent = 'ANALYZE';
    }

    function quickAnalyze(token) { document.getElementById('tokenInput').value = token; analyzeToken(); }

    function showVerdict(moderator, token) {
      const section = document.getElementById('verdictSection');
      const scoreEl = document.getElementById('verdictScore');
      const labelEl = document.getElementById('verdictLabel');
      const { risk, category, recommendation } = moderator;
      section.style.display = 'block';
      section.className = `verdict-section ${category === 'high' ? 'high-risk' : 'low-risk'}`;
      scoreEl.className = `verdict-score ${category === 'high' ? 'high-risk' : 'low-risk'}`;
      labelEl.className = `verdict-label ${category === 'high' ? 'high-risk' : 'low-risk'}`;
      gsap.to({val: 0}, {val: risk, duration: 2, ease: 'power2.out', onUpdate: function() { scoreEl.textContent = this.targets()[0].val.toFixed(2); }});
      labelEl.textContent = category === 'trusted' ? 'TRUSTED' : (category === 'high' ? 'HIGH RISK' : 'LOW RISK');
      // Quantum scan for premium
      const isPremium = ['Premium','Pro'].includes(safeGet('selectedTier'));
      const contract = tokenData?.baseToken?.address;
      const chain = tokenData?.chainId || 'base';
      if (isPremium && contract) {
        document.querySelector('.quantum-scan span').textContent = 'Scanning contract...';
        fetch('https://cryptobros-backend.onrender.com/api/goplus/token-security', {
          method: 'POST', headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ chain_id: chain, contract_addresses: contract })
        }).then(res => res.json()).then(data => {
          const sec = data.result?.[contract];
          if (sec) {
            let scan = '\nüîç QUANTUM CONTRACT SCAN\n';
            scan += `‚Üí Ownership: ${sec.is_open_source === '1' ? 'RENOUNCED' : 'ACTIVE (CRITICAL RISK)'}\n`;
            scan += `‚Üí Taxes: Buy ${sec.buy_tax || '0'}% | Sell ${sec.sell_tax || '0'}%\n`;
            scan += `‚Üí Liquidity: ${sec.is_proxy === '0' ? 'LOCKED' : 'UNLOCKED (RUG RISK)'}\n`;
            scan += `‚Üí Honeypot: ${sec.is_honeypot === '1' ? 'DETECTED' : 'CLEAR'}\n`;
            scan += `‚Üí Ownership Recovery: ${sec.can_take_back_ownership === '1' ? 'ENABLED (DANGER)' : 'DISABLED'}\n`;
            scan += `‚Üí Anti-Whale: ${sec.is_anti_whale === '1' ? 'ACTIVE' : 'INACTIVE'}`;
            document.getElementById('verdictDetails').innerHTML = `<pre style="color:#00ff9d">${scan}</pre>`;
          }
        }).catch(() => { document.getElementById('verdictDetails').innerHTML = '<pre style="color:#ff4d4d">‚ö†Ô∏è Quantum scan unavailable</pre>'; });
      }
    }

    function saveVerdict() {
      const token = document.getElementById('tokenInput').value.trim();
      const risk = document.getElementById('verdictScore').textContent;
      const label = document.getElementById('verdictLabel').textContent;
      const verdict = { token, risk, label, timestamp: Date.now() };
      let history = safeGet('verdictHistory', []);
      history.unshift(verdict);
      safeSet('verdictHistory', history.slice(0, 50));
      const btn = document.querySelector('.save-verdict-btn');
      btn.textContent = '‚úì SAVED';
      setTimeout(() => { btn.textContent = 'üíæ SAVE VERDICT'; }, 2000);
      // Share option
      if (confirm('Share verdict on X/Twitter?')) {
        const text = `CryptoBros Tribunal judged ${token} ‚Äî Risk: ${risk} üö® ${label} #CryptoBros`;
        window.open(`https://twitter.com/intent/tweet?text=${encodeURIComponent(text)}`, '_blank');
      }
    }

    function toggleSound() { SoundSystem.toggle(); }

    function initTilt() {
      if (CONFIG.isMobile) return;
      try { VanillaTilt.init(document.querySelectorAll('.agent-card'), { max: 8, speed: 400, glare: true, 'max-glare': 0.3, scale: 1.02 }); }
      catch(e) { console.warn('Tilt init failed'); }
    }

    // INIT
    window.addEventListener('DOMContentLoaded', async () => {
      const savedSound = safeGet('tribunalSounds', 'false');
      if (savedSound === 'true') { CONFIG.soundsEnabled = true; document.getElementById('soundToggle').textContent = 'üîä'; }
      await initParticles();
      await SoundSystem.init();
      initTilt();
      await runLoadingSequence();
      console.log('üî• Judgment Chamber + Real Logic initialized');
    });
    window.addEventListener('resize', () => { CONFIG.isMobile = window.innerWidth < 768; });
  </script>
</body>
</html>
